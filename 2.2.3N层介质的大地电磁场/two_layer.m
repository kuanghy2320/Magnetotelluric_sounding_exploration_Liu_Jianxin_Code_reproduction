warning off
clc
clear all
 
%%参数定义
h1=20000;
p=[1 0.000000000000000001;1 0.0025;1 0.025;1 0.1;1 0.25;1 1;1 3;1 10;1 25;1 200;1 10000000000000000000000];
T=[1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,20000,30000,40000,50000,60000,70000,80000,90000,100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,2000000,3000000,4000000,5000000,6000000,7000000,8000000,9000000,10000000,20000000,30000000,40000000,50000000,60000000,70000000,80000000,90000000,100000000];
fs=1./T;
u=4*pi*1e-7;%真空中的磁导率
 
figure(1)
for n = 1:1:11
    x=1;
    for f = fs
        k=sqrt(-j*2*pi*f*u./p(n,:));
        Z(x,2)=-j*2*pi*f*u/k(2);
        z1=-j*2*pi*f*u/k(1);
        L2=(z1-Z(x,2))/(z1+Z(x,2));
        Z(x,1)=z1*(1-L2*exp(-2*k(1)*h1))/(1+L2*exp(-2*k(1)*h1));
        x=x+1;
    end
    d(n,:)=(abs(Z(:,1)).^2./(2*pi*fs'*u))';%卡尼亚视电阻率
    loglog((1./fs),(d(n,:)./p(n,1)));%振幅曲线
    hold on
end
hold off
 
 
for n = 1:1:11
    x=1;
    for f = fs
        k=sqrt(-j*2*pi*f*u./p(n,:));
        Z(x,2)=-j*2*pi*f*u/k(2);
        z1=-j*2*pi*f*u/k(1);
        L2=(z1-Z(x,2))/(z1+Z(x,2));
        Z(x,1)=z1*(1-L2*exp(-2*k(1)*h1))/(1+L2*exp(-2*k(1)*h1));
        x=x+1;
    end
    
   d(n,:)=(phase(Z(:,1)))'.*180./pi;%弧度转角度
   L(n,:)=abs(d(n,:));  
  
   figure(2)%相位曲线
   semilogx((1./fs),  L(n,:));
   hold on
end